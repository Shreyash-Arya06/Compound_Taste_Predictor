# Compound_Taste_Predictor
We will be predicting taste of compounds (bitter or sweet) considering their SMILES representation. We will be using Genetic Algorithm and Weighted Edit Distance Algorithm for the purpose.

## Idea behind the model
First a required dataset is downloaded from kaggle, [bittersweet24](https://www.kaggle.com/datasets/sakshiranjan/bittersweet24). The downloaded data is processed to extract only the required values. We will be using the Genetic Algorithm to generate weights (depicted as chromosome in the algorithm) and the Weighted Edit Distance will be used to calculate the similarity score. An array consisting insertion weight, deletion weight and substitution weight forms a chromosome of the genetic algorithm. To calculate the fitness of the weights obtained, a certain score will be given depending upon the similarity score obtained.

## How the algorithms are being used?
First the calculate_weights.py is executed and it calls the genetic_algorithm.py by describing the population count and number of generations. The genetic_algorithm.py generates chromoses which includes all the three weights. To evaluate the fitness of chromosome, it calls fitness_calculator.py. fitness_calculator.py uses the obtained weights to calculate the similarity score. To calculate the fitness, each bitter smiles is compared with all the bitter smiles, similarly each sweet smiles is compared with all the sweet smiles and the same is with tasteless. Averaging the scores obatained from all the three evaluations, the final score of the weights is obtianed. There are two modes in weighted_edit_distance.py, namely train and test. For train mode, the distance of each smiles is calculated with all the smiles of the particular file and their average is returned. For test mode, the test smiles is compared with all the smiles in a sheet, and the best obtained score is returned. The test smiles is evaluated with all the three files, and their score is compared. The highest score represents the prdicted taste of the smiles.

### Steps to train the model again in your local machine:
1. Run extract_data.py in datapreprocess to extract the required columns from both the train and test set.
2. Run preprocess_trainset.py and separate the train data set into three files, consisting bitter, sweet and tasteless compounds separately. The code also removes any occurance of testing compounds in the train set. It also drops the repetitive compounds. The required datasets will be created in the respective folders.
3. The codes of Genetic Algorithm, Wieghted Edit Distance Algorithm are implemented separately. To evaluate the calculated weights, i had written fitness_calculator.py. All the codes are in the folder 'models'. Run calculate_weights.py in the same folder to generate the best weights. The genetic_algorithm.py generates weights and the fitness_calculator.py uses weighted_edit_distance.py to evaluate the generated weights. All the generated wights get mentioned in a text file and the best obtained weight is added separately to another text file.
4. After obtaining the best weights, it's time to evalute the efficiency of the obtained weights. For the purpose, update the weights in evaluate.py to the best weoghts obtained. After updating the weights, run efficiency_calculator.py to calculate the efficiency of the obtained weights using the test data set.

# The current weights produce 71% efficiency on the tset set.